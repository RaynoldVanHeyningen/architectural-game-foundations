
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../09-chapter-9/">
      
      
        <link rel="next" href="../11-chapter-11/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Chapter 10 - Architectural Foundations: Building Modular & Moddable AAA Game Projects</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="sky" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-10-building-with-components-the-entity-component-system-ecs-paradigm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Architectural Foundations: Building Modular &amp; Moddable AAA Game Projects" class="md-header__button md-logo" aria-label="Architectural Foundations: Building Modular & Moddable AAA Game Projects" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Architectural Foundations: Building Modular & Moddable AAA Game Projects
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 10
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Architectural Foundations: Building Modular &amp; Moddable AAA Game Projects" class="md-nav__button md-logo" aria-label="Architectural Foundations: Building Modular & Moddable AAA Game Projects" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Architectural Foundations: Building Modular & Moddable AAA Game Projects
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-chapter-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-chapter-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-chapter-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-chapter-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-chapter-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-chapter-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-chapter-7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-chapter-8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-chapter-9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter 10
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 10
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-10-building-with-components-the-entity-component-system-ecs-paradigm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 10: Building with Components: The Entity-Component-System (ECS) Paradigm
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 10: Building with Components: The Entity-Component-System (ECS) Paradigm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept-explanation-the-full-ecs-paradigm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concept Explanation: The Full ECS Paradigm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architectural-reasoning-data-oriented-design-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architectural Reasoning: Data-Oriented Design and Performance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production-mindset-notes-optimizing-for-scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Mindset Notes: Optimizing for Scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-instructions-implementing-a-basic-ecs-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Instructions: Implementing a Basic ECS Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkpoint &amp; Exercise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-chapter-11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 11
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-chapter-12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-chapter-13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 13
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-chapter-14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 14
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-chapter-15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 15
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../16-chapter-16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 16
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../17-chapter-17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 17
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-chapter-18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 18
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../19-chapter-19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 19
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../20-chapter-20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 20
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-10-building-with-components-the-entity-component-system-ecs-paradigm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 10: Building with Components: The Entity-Component-System (ECS) Paradigm
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 10: Building with Components: The Entity-Component-System (ECS) Paradigm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept-explanation-the-full-ecs-paradigm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concept Explanation: The Full ECS Paradigm
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architectural-reasoning-data-oriented-design-and-performance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architectural Reasoning: Data-Oriented Design and Performance
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production-mindset-notes-optimizing-for-scale" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Mindset Notes: Optimizing for Scale
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-instructions-implementing-a-basic-ecs-framework" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Instructions: Implementing a Basic ECS Framework
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkpoint &amp; Exercise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Chapter 10</h1>

<h2 id="chapter-10-building-with-components-the-entity-component-system-ecs-paradigm">Chapter 10: Building with Components: The Entity-Component-System (ECS) Paradigm</h2>
<h3 id="goal">Goal</h3>
<p>The goal of this chapter is to deepen your understanding of component-based design by introducing the full <strong>Entity-Component-System (ECS) paradigm</strong>. You will learn how to structure not just entities and components, but also dedicated <em>systems</em> that operate on components, further enhancing modularity, performance (conceptually), and scalability.</p>
<h3 id="concept-explanation-the-full-ecs-paradigm">Concept Explanation: The Full ECS Paradigm</h3>
<p>In Chapter 3, we introduced the concept of composition using Entities and Components. An Entity was a container, and Components provided behavior. The entity itself still called <code>Update()</code> on its components.</p>
<p>The full <strong>Entity-Component-System (ECS)</strong> paradigm takes this a step further by introducing a third core concept: <strong>Systems</strong>.</p>
<ul>
<li><strong>Entity</strong>: A unique identifier. It's purely an ID; it has no data or behavior of its own. It's just a handle to a collection of components.</li>
<li><strong>Component</strong>: Raw data. Components hold only data (e.g., <code>PositionComponent { x, y, z }</code>, <code>HealthComponent { value }</code>). They contain no logic or methods beyond simple getters/setters.</li>
<li><strong>System</strong>: Logic that operates on specific sets of components. Systems iterate over entities that possess the components they are interested in and perform operations on their data. Systems contain the <em>behavior</em>.</li>
</ul>
<p><strong>How ECS Differs from Simple Component-Based Design:</strong></p>
<p>In simple component-based design, an <code>Entity</code> often looks like this:</p>
<pre><code class="language-pseudocode">class Entity:
    components: List&lt;IComponent&gt;
    function Update(delta_time):
        for comp in components:
            comp.Update(delta_time) // Component contains logic
</code></pre>
<p>Here, components still have <code>Update()</code> methods and often contain logic. The <code>Entity</code> is still somewhat active.</p>
<p>In a pure ECS, the <code>Entity</code> is passive, and <code>Components</code> are pure data. <code>Systems</code> are active:</p>
<pre><code class="language-pseudocode">// Entity is just an ID
type EntityID: integer

// Component is pure data
class PositionComponent:
    x: float
    y: float
    z: float

class HealthComponent:
    value: integer

// System contains logic
class MovementSystem:
    function Update(delta_time, all_entities, all_positions, all_velocities):
        for each entity_id that has PositionComponent AND VelocityComponent:
            position = all_positions.get(entity_id)
            velocity = all_velocities.get(entity_id)
            position.x = position.x + velocity.x * delta_time
            // ... update position
</code></pre>
<p>The key shift is that <strong>logic moves out of the components and into the systems</strong>. Systems perform operations on <em>collections</em> of components, rather than individual components updating themselves.</p>
<h3 id="architectural-reasoning-data-oriented-design-and-performance">Architectural Reasoning: Data-Oriented Design and Performance</h3>
<p>ECS offers significant architectural advantages, especially for AAA games with many interacting objects:</p>
<ul>
<li><strong>Data-Oriented Design (DOD)</strong>: ECS encourages storing components of the same type in contiguous memory blocks. This is highly beneficial for modern CPUs, which operate much faster when accessing data that is close together (cache coherence). A <code>MovementSystem</code> can iterate through all <code>PositionComponents</code> and <code>VelocityComponents</code> very efficiently.</li>
<li><strong>Extreme Modularity</strong>: Components are just data bags, making them incredibly reusable. Systems are highly focused on specific operations. This makes it easy to add, remove, or modify features by creating new components or systems.</li>
<li><strong>Clearer Separation of Concerns</strong>: The separation of Entity (identity), Component (data), and System (logic) is absolute. This enforces SRP at a fundamental level.</li>
<li><strong>Scalability</strong>: ECS is excellent for managing thousands of game objects. Systems can process large batches of data in parallel, leading to better performance.</li>
<li><strong>Testability</strong>: Systems are pure functions operating on data. This makes them very easy to unit test in isolation.</li>
<li><strong>Runtime Flexibility</strong>: You can dynamically add/remove components from entities at runtime, instantly changing their behavior, without complex inheritance hierarchies.</li>
</ul>
<h3 id="production-mindset-notes-optimizing-for-scale">Production Mindset Notes: Optimizing for Scale</h3>
<p>Many modern AAA engines and frameworks (e.g., Unity's DOTS/ECS, Unreal Engine's Data-Oriented Design practices, custom in-house engines) are adopting or heavily influenced by ECS principles for performance and scalability reasons.</p>
<ul>
<li><strong>Performance at Scale</strong>: When you have thousands of bullets, particles, or AI agents, traditional object-oriented approaches can hit performance bottlenecks due to scattered data in memory. ECS's DOD approach helps mitigate this.</li>
<li><strong>Parallelization</strong>: Systems are often designed to run in parallel on multi-core CPUs, further boosting performance.</li>
<li><strong>Predictable Performance</strong>: With systems processing data in batches, performance characteristics can be more predictable than with individual objects updating themselves.</li>
<li><strong>Complex Interactions</strong>: ECS provides a clean way to manage complex interactions. A <code>DamageSystem</code> can iterate over all <code>DamageEventComponents</code> and <code>HealthComponents</code> to apply damage, without needing to know the specific types of entities involved.</li>
</ul>
<h3 id="step-by-step-instructions-implementing-a-basic-ecs-framework">Step-by-Step Instructions: Implementing a Basic ECS Framework</h3>
<p>We will build a minimalistic ECS framework. This will involve:
1.  Redefining <code>Entity</code> as a simple ID.
2.  Defining <code>Component</code> as pure data.
3.  Creating <code>System</code> interfaces and a <code>World</code> (or <code>EntityManager</code>) to manage them.</p>
<p><strong>1. Redefine <code>Entity</code> (Simple ID):</strong></p>
<p>An entity is now just a unique identifier.</p>
<pre><code class="language-pseudocode">// Source/Core/Entity.pseudocode
type EntityID: integer // A simple integer ID for an entity
</code></pre>
<p><strong>2. Redefine <code>IComponent</code> and Create Data-Only Components:</strong></p>
<p>Our <code>IComponent</code> interface now reflects pure data. Actual components will be simple data structures.</p>
<pre><code class="language-pseudocode">// Source/Core/Interfaces/IComponent.pseudocode
interface IComponent:
    // No methods, just a marker interface for data-only components
    pass

// Source/Gameplay/Components/PositionComponent.pseudocode
class PositionComponent implements IComponent:
    x: float
    y: float
    z: float

    function PositionComponent(initial_x: float, initial_y: float, initial_z: float):
        x = initial_x
        y = initial_y
        z = initial_z

// Source/Gameplay/Components/VelocityComponent.pseudocode
class VelocityComponent implements IComponent:
    vx: float
    vy: float
    vz: float

    function VelocityComponent(initial_vx: float, initial_vy: float, initial_vz: float):
        vx = initial_vx
        vy = initial_vy
        vz = initial_vz

// Source/Gameplay/Components/HealthComponent.pseudocode
class HealthComponent implements IComponent:
    current_health: integer
    max_health: integer

    function HealthComponent(initial_health: integer, initial_max_health: integer):
        current_health = initial_health
        max_health = initial_max_health
</code></pre>
<p><strong>3. Define <code>ISystem</code> Interface:</strong></p>
<p>Systems will implement this interface and contain the game logic.</p>
<pre><code class="language-pseudocode">// Source/Core/Interfaces/ISystem.pseudocode
interface ISystem:
    function Initialize(world: World):
        // Called once when the system is added to the world
        pass

    function Update(delta_time: float):
        // Called every frame to process components
        pass
</code></pre>
<p><strong>4. Create a <code>World</code> (or <code>EntityManager</code>) to Manage Entities and Components:</strong></p>
<p>This <code>World</code> is the central hub. It creates entities, adds/removes components, and gives systems access to components.</p>
<pre><code class="language-pseudocode">// Source/Core/World.pseudocode
class World:
    next_entity_id: EntityID

    // Stores components by entity ID and component type
    // Example: Map&lt;EntityID, Map&lt;Type, IComponent&gt;&gt;
    components_by_entity: Map&lt;EntityID, Map&lt;Type, IComponent&gt;&gt;

    // Stores systems
    systems: List&lt;ISystem&gt;

    function World():
        next_entity_id = 0
        components_by_entity = new Map&lt;EntityID, Map&lt;Type, IComponent&gt;&gt;()
        systems = new List&lt;ISystem&gt;()

    function CreateEntity(): returns EntityID:
        new_id = next_entity_id
        next_entity_id = next_entity_id + 1
        components_by_entity[new_id] = new Map&lt;Type, IComponent&gt;()
        print(&quot;Created entity with ID: &quot; + new_id)
        return new_id

    function DestroyEntity(entity_id: EntityID):
        if components_by_entity.ContainsKey(entity_id):
            components_by_entity.Remove(entity_id)
            print(&quot;Destroyed entity with ID: &quot; + entity_id)

    function AddComponent(entity_id: EntityID, component: IComponent):
        if components_by_entity.ContainsKey(entity_id):
            components_by_entity[entity_id][component.GetType()] = component
            print(&quot;Added &quot; + component.GetType().name + &quot; to entity &quot; + entity_id)
        else:
            print(&quot;Error: Cannot add component to non-existent entity: &quot; + entity_id)

    function RemoveComponent(entity_id: EntityID, component_type: Type):
        if components_by_entity.ContainsKey(entity_id) and components_by_entity[entity_id].ContainsKey(component_type):
            components_by_entity[entity_id].Remove(component_type)
            print(&quot;Removed &quot; + component_type.name + &quot; from entity &quot; + entity_id)

    function GetComponent&lt;T: IComponent&gt;(entity_id: EntityID): returns T:
        if components_by_entity.ContainsKey(entity_id) and components_by_entity[entity_id].ContainsKey(T):
            return components_by_entity[entity_id][T] as T
        return null

    function HasComponent(entity_id: EntityID, component_type: Type): returns boolean:
        return components_by_entity.ContainsKey(entity_id) and components_by_entity[entity_id].ContainsKey(component_type)

    function GetEntitiesWithComponents(component_types: List&lt;Type&gt;): returns List&lt;EntityID&gt;:
        matching_entities = new List&lt;EntityID&gt;()
        for entity_id in components_by_entity.Keys():
            has_all_components = true
            for comp_type in component_types:
                if not HasComponent(entity_id, comp_type):
                    has_all_components = false
                    break
            if has_all_components:
                matching_entities.Add(entity_id)
        return matching_entities

    function AddSystem(system: ISystem):
        systems.Add(system)
        system.Initialize(this) // Pass world reference to system
        print(&quot;Added system: &quot; + system.GetType().name)

    function Update(delta_time: float):
        for system in systems:
            system.Update(delta_time)
</code></pre>
<p><strong>5. Create a <code>MovementSystem</code> (Logic for <code>Position</code> and <code>Velocity</code>):</strong></p>
<p>This system will iterate over all entities that have <em>both</em> a <code>PositionComponent</code> and a <code>VelocityComponent</code> and update their positions.</p>
<pre><code class="language-pseudocode">// Source/Gameplay/Systems/MovementSystem.pseudocode
class MovementSystem implements ISystem:
    world: World

    function Initialize(world_instance: World):
        world = world_instance
        print(&quot;MovementSystem initialized.&quot;)

    function Update(delta_time: float):
        // Get all entities that have both Position and Velocity components
        entities_to_update = world.GetEntitiesWithComponents([PositionComponent.GetType(), VelocityComponent.GetType()])

        for entity_id in entities_to_update:
            pos_comp = world.GetComponent&lt;PositionComponent&gt;(entity_id)
            vel_comp = world.GetComponent&lt;VelocityComponent&gt;(entity_id)

            if pos_comp is not null and vel_comp is not null:
                pos_comp.x = pos_comp.x + vel_comp.vx * delta_time
                pos_comp.y = pos_comp.y + vel_comp.vy * delta_time
                pos_comp.z = pos_comp.z + vel_comp.vz * delta_time
                // print(&quot;Entity &quot; + entity_id + &quot; moved to: (&quot; + pos_comp.x + &quot;, &quot; + pos_comp.y + &quot;, &quot; + pos_comp.z + &quot;)&quot;)
</code></pre>
<p><strong>6. Integrate with <code>GameLoop</code> and <code>Main</code>:</strong></p>
<p>The <code>GameLoop</code> will now manage the <code>World</code>, and <code>Main</code> will set up the <code>World</code> and its systems.</p>
<pre><code class="language-pseudocode">// Source/Core/GameLoop.pseudocode (Updated)
class GameLoop:
    // ... existing fields ...
    game_world: World // Reference to our ECS world

    function GameLoop(world_instance: World): // Constructor now takes a World
        systems = new List&lt;IGameSystem&gt;()
        active_entities = new List&lt;Entity&gt;() // This list might become less relevant in pure ECS
        is_running = false
        last_frame_time = GetCurrentTime()
        game_world = world_instance // Assign the world

    // Register a system with the game loop (these are IGameSystems, like InputSystem, not ISystems from ECS)
    function RegisterSystem(system: IGameSystem):
        systems.Add(system)

    // Run the main game loop
    function Run():
        is_running = true

        print(&quot;GameLoop: Initializing core systems...&quot;)
        for system in systems:
            system.Initialize()

        print(&quot;GameLoop: Starting main loop...&quot;)
        while is_running:
            current_time = GetCurrentTime()
            delta_time = current_time - last_frame_time
            last_frame_time = current_time
            delta_time = min(delta_time, 0.25)

            ProcessInput()

            // Update core systems (Input, GameState, EventManagement, etc.)
            for system in systems:
                system.Update(delta_time)

            // --- Update the ECS World ---
            game_world.Update(delta_time) // This calls all registered ECS ISystems

            RenderFrame()

            if ShouldQuitGame():
                is_running = false

        print(&quot;GameLoop: Shutting down core systems...&quot;)
        for system in systems:
            system.Shutdown()

        print(&quot;GameLoop: Exited.&quot;)

// Source/Main.pseudocode (Updated conceptual application entry point)

// ... existing global systems ...

function Main():
    print(&quot;Application starting...&quot;)

    global_config_manager.LoadConfig&lt;WeaponData&gt;(&quot;Config/Weapons/Weapon_AssaultRifle.json&quot;, &quot;AssaultRifle_01&quot;)
    global_config_manager.LoadConfig&lt;WeaponData&gt;(&quot;Config/Weapons/Weapon_Pistol.json&quot;, &quot;Pistol_01&quot;)

    // --- Setup the ECS World ---
    game_world = new World()
    game_world.AddSystem(new MovementSystem()) // Add our ECS movement system

    // --- Create ECS Entities ---
    player_entity_id = game_world.CreateEntity()
    game_world.AddComponent(player_entity_id, new PositionComponent(0, 0, 0))
    game_world.AddComponent(player_entity_id, new VelocityComponent(1, 0, 0)) // Player moves right
    game_world.AddComponent(player_entity_id, new HealthComponent(100, 100))

    enemy_entity_id = game_world.CreateEntity()
    game_world.AddComponent(enemy_entity_id, new PositionComponent(10, 0, 0))
    game_world.AddComponent(enemy_entity_id, new VelocityComponent(-0.5, 0, 0)) // Enemy moves left
    game_world.AddComponent(enemy_entity_id, new HealthComponent(50, 50))


    game_loop = new GameLoop(game_world) // Pass the world to the game loop

    // Register core systems (these are IGameSystem, not ECS ISystem)
    game_loop.RegisterSystem(global_input_system)
    game_loop.RegisterSystem(global_game_state_system)
    game_loop.RegisterSystem(global_event_system)
    game_loop.RegisterSystem(global_resource_system)
    game_loop.RegisterSystem(global_ui_system)

    // The GameLoop's active_entities list from Chapter 8 is now less central.
    // Individual entities are managed by the World and processed by ECS Systems.
    // For now, we keep it as a placeholder, but in a pure ECS, entities are
    // only IDs and their components are what systems operate on.

    game_loop.Run()

    print(&quot;Application finished.&quot;)
</code></pre>
<h3 id="checkpoint-exercise">Checkpoint &amp; Exercise</h3>
<ul>
<li><strong>Task</strong>:<ol>
<li>Update <code>Entity.pseudocode</code> to be just <code>type EntityID: integer</code>.</li>
<li>Create <code>IComponent.pseudocode</code> (empty interface).</li>
<li>Create <code>PositionComponent.pseudocode</code>, <code>VelocityComponent.pseudocode</code>, <code>HealthComponent.pseudocode</code> in <code>Source/Gameplay/Components/</code>.</li>
<li>Create <code>ISystem.pseudocode</code> in <code>Source/Core/Interfaces/</code>.</li>
<li>Create <code>World.pseudocode</code> in <code>Source/Core/</code>.</li>
<li>Create <code>MovementSystem.pseudocode</code> in <code>Source/Gameplay/Systems/</code>.</li>
<li>Update <code>GameLoop.pseudocode</code> and <code>Main.pseudocode</code> to integrate the <code>World</code> and <code>MovementSystem</code>.</li>
</ol>
</li>
<li><strong>Reflection</strong>: This is a significant shift. You've moved from entities having components that contain logic, to entities being just IDs, components being pure data, and systems containing all the logic. This architecture is incredibly powerful for large-scale games, enabling high performance and extreme flexibility. While this is a basic implementation, it demonstrates the core principles of ECS.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>