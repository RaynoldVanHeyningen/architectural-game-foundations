
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../10-chapter-10/">
      
      
        <link rel="next" href="../12-chapter-12/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Chapter 11 - Architectural Foundations: Building Modular & Moddable AAA Game Projects</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="sky" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-11-the-event-bus-decoupling-game-systems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Architectural Foundations: Building Modular &amp; Moddable AAA Game Projects" class="md-header__button md-logo" aria-label="Architectural Foundations: Building Modular & Moddable AAA Game Projects" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Architectural Foundations: Building Modular & Moddable AAA Game Projects
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 11
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Architectural Foundations: Building Modular &amp; Moddable AAA Game Projects" class="md-nav__button md-logo" aria-label="Architectural Foundations: Building Modular & Moddable AAA Game Projects" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Architectural Foundations: Building Modular & Moddable AAA Game Projects
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-chapter-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 1
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-chapter-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 2
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-chapter-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 3
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-chapter-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 4
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-chapter-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 5
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-chapter-6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 6
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-chapter-7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 7
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-chapter-8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 8
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-chapter-9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 9
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-chapter-10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 10
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter 11
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 11
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-11-the-event-bus-decoupling-game-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 11: The Event Bus: Decoupling Game Systems
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 11: The Event Bus: Decoupling Game Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept-explanation-what-is-an-event-bus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concept Explanation: What is an Event Bus?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architectural-reasoning-the-key-to-loose-coupling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architectural Reasoning: The Key to Loose Coupling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production-mindset-notes-debugging-and-performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Mindset Notes: Debugging and Performance Considerations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-instructions-implementing-a-generic-event-bus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Instructions: Implementing a Generic Event Bus
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkpoint &amp; Exercise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-chapter-12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 12
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-chapter-13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 13
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-chapter-14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 14
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-chapter-15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 15
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../16-chapter-16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 16
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../17-chapter-17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 17
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-chapter-18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 18
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../19-chapter-19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 19
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../20-chapter-20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter 20
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-11-the-event-bus-decoupling-game-systems" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter 11: The Event Bus: Decoupling Game Systems
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Chapter 11: The Event Bus: Decoupling Game Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#goal" class="md-nav__link">
    <span class="md-ellipsis">
      
        Goal
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept-explanation-what-is-an-event-bus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Concept Explanation: What is an Event Bus?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architectural-reasoning-the-key-to-loose-coupling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architectural Reasoning: The Key to Loose Coupling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production-mindset-notes-debugging-and-performance-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Production Mindset Notes: Debugging and Performance Considerations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step-instructions-implementing-a-generic-event-bus" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step-by-Step Instructions: Implementing a Generic Event Bus
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#checkpoint-exercise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Checkpoint &amp; Exercise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Chapter 11</h1>

<h2 id="chapter-11-the-event-bus-decoupling-game-systems">Chapter 11: The Event Bus: Decoupling Game Systems</h2>
<h3 id="goal">Goal</h3>
<p>The goal of this chapter is to design and implement a robust <strong>Event Bus (or Event System)</strong>. You will learn how to use this pattern to facilitate communication between disparate game systems and components without them needing direct knowledge of each other, thereby achieving loose coupling and enhancing modularity and extensibility.</p>
<h3 id="concept-explanation-what-is-an-event-bus">Concept Explanation: What is an Event Bus?</h3>
<p>An <strong>Event Bus</strong> (also known as an Event System, Message Bus, or Publisher-Subscriber pattern) is a central communication hub that allows different parts of your game to communicate with each other in a highly decoupled manner. Instead of directly calling methods on other objects, components and systems can:</p>
<ol>
<li><strong>Publish (or "Fire" / "Emit") Events</strong>: Announce that something has happened, without caring who (if anyone) is listening.</li>
<li><strong>Subscribe (or "Listen" / "Register") to Events</strong>: Register interest in specific types of events, and be notified when those events occur.</li>
</ol>
<p>The Event Bus sits in the middle, managing these subscriptions and delivering events to all registered listeners.</p>
<p><strong>Analogy</strong>: Think of a radio station. The station (publisher) broadcasts information (events) without knowing who is listening. Listeners (subscribers) tune into specific frequencies (event types) to receive information, without knowing who is broadcasting. The radio waves (event bus) carry the information.</p>
<h3 id="architectural-reasoning-the-key-to-loose-coupling">Architectural Reasoning: The Key to Loose Coupling</h3>
<p>The Event Bus is a cornerstone of modular and scalable game architecture for several reasons:</p>
<ul>
<li><strong>Loose Coupling</strong>: This is its primary benefit. A <code>PlayerHealthComponent</code> doesn't need to know about the <code>UIHUDSystem</code> or the <code>AchievementSystem</code>. When the player takes damage, <code>PlayerHealthComponent</code> simply publishes a <code>PlayerTookDamageEvent</code>. The <code>UIHUDSystem</code> (if subscribed) updates the health bar, and the <code>AchievementSystem</code> (if subscribed) checks if a "No Damage Taken" achievement is still valid. Neither system has a direct dependency on the other.</li>
<li><strong>Increased Modularity</strong>: Components and systems become more self-contained. They only need to know how to publish events and how to react to events they're interested in.</li>
<li><strong>Enhanced Extensibility &amp; Moddability</strong>: Adding new features or mods becomes much easier. A modder can create a new system that subscribes to existing events (e.g., <code>PlayerDiedEvent</code>) to trigger custom behavior (e.g., "Respawn in Hell" mod), without modifying core game code.</li>
<li><strong>Reduced Complexity</strong>: Direct dependencies can create a "spaghetti code" mess where objects are tightly intertwined. The Event Bus simplifies the dependency graph, making the system easier to understand and manage.</li>
<li><strong>Concurrency Potential</strong>: Events can be processed asynchronously, allowing for potential performance gains in multi-threaded environments (though our pseudocode will be synchronous for simplicity).</li>
</ul>
<h3 id="production-mindset-notes-debugging-and-performance-considerations">Production Mindset Notes: Debugging and Performance Considerations</h3>
<p>While powerful, an Event Bus also requires careful management in production:</p>
<ul>
<li><strong>Debugging Challenges</strong>: It can be harder to trace the flow of execution when everything is event-driven. Tools to visualize event flow and see who is subscribing to what are invaluable.</li>
<li><strong>Performance Overhead</strong>: Publishing and processing events has a small overhead. While typically negligible, for extremely high-frequency events (e.g., every pixel update), direct calls might be more appropriate. It's a tool to be used judiciously.</li>
<li><strong>Event Naming &amp; Data Consistency</strong>: Clear naming conventions for event types and consistent data structures for event payloads are crucial for maintainability.</li>
<li><strong>Avoiding Event Abuse</strong>: Don't use events for every single interaction. Simple, direct method calls are fine for tightly coupled components that are designed to work together (e.g., a <code>PlayerController</code> directly telling its <code>MovementComponent</code> to move). Events are best for notifications and broad communication.</li>
</ul>
<h3 id="step-by-step-instructions-implementing-a-generic-event-bus">Step-by-Step Instructions: Implementing a Generic Event Bus</h3>
<p>We will implement a simple yet effective <code>EventBus</code> that allows for generic event types and data payloads.</p>
<p><strong>1. Define a Generic <code>Event</code> Structure:</strong></p>
<p>All events will conform to a basic structure.</p>
<pre><code class="language-pseudocode">// Source/Core/Events/Event.pseudocode
class Event:
    event_type: string // A unique string identifier for the event (e.g., &quot;PlayerDied&quot;, &quot;ItemPickedUp&quot;)
    data: Map&lt;string, any&gt; // A dictionary to hold arbitrary event data

    function Event(type: string, event_data: Map&lt;string, any&gt; = new Map&lt;string, any&gt;()):
        event_type = type
        data = event_data
</code></pre>
<p><strong>2. Define the <code>IEventManagementSystem</code> Implementation:</strong></p>
<p>We'll implement the interface we defined in Chapter 7. This will be our <code>EventBus</code> class.</p>
<pre><code class="language-pseudocode">// Source/Systems/EventManagement/EventBus.pseudocode
class EventBus implements IEventManagementSystem, IGameSystem: // Implements both interfaces
    // Stores subscribers for each event type
    // Map&lt;EventType (string), List&lt;Function (listener)&gt;&gt;
    subscribers: Map&lt;string, List&lt;Function&gt;&gt;

    // Constructor
    function EventBus():
        subscribers = new Map&lt;string, List&lt;Function&gt;&gt;()

    // IGameSystem methods (empty for now, as EventBus is mostly passive)
    function Initialize():
        print(&quot;EventBus Initialized.&quot;)
        pass

    function Update(delta_time: float):
        pass

    function Shutdown():
        print(&quot;EventBus Shutting Down.&quot;)
        subscribers.Clear() // Clear all subscriptions
        pass

    // IEventManagementSystem methods

    // Register a listener function for a specific event type
    function Subscribe(event_type: string, listener_function: Function):
        if not subscribers.ContainsKey(event_type):
            subscribers[event_type] = new List&lt;Function&gt;()

        if not subscribers[event_type].Contains(listener_function):
            subscribers[event_type].Add(listener_function)
            print(&quot;Subscribed function to event: &quot; + event_type)
        else:
            print(&quot;Warning: Function already subscribed to event: &quot; + event_type)

    // Unregister a listener function
    function Unsubscribe(event_type: string, listener_function: Function):
        if subscribers.ContainsKey(event_type):
            if subscribers[event_type].Contains(listener_function):
                subscribers[event_type].Remove(listener_function)
                print(&quot;Unsubscribed function from event: &quot; + event_type)
            else:
                print(&quot;Warning: Function not found among subscribers for event: &quot; + event_type)

    // Publish an event, notifying all subscribers
    function Publish(event_type: string, event_data: Map&lt;string, any&gt; = new Map&lt;string, any&gt;()):
        event_to_publish = new Event(event_type, event_data)
        print(&quot;Publishing event: &quot; + event_type + &quot; with data: &quot; + event_data.ToString())

        if subscribers.ContainsKey(event_type):
            // Iterate over a copy of the list to allow listeners to unsubscribe themselves
            listeners_copy = new List&lt;Function&gt;(subscribers[event_type])
            for listener_function in listeners_copy:
                // Call the listener function, passing the event
                listener_function(event_to_publish)
        else:
            print(&quot;No subscribers for event: &quot; + event_type)
</code></pre>
<p><strong>3. Example Usage: Health Component and UI Listener:</strong></p>
<p>Let's modify our <code>HealthComponent</code> to publish events and create a conceptual <code>UIHealthDisplaySystem</code> to subscribe.</p>
<pre><code class="language-pseudocode">// Source/Gameplay/Components/HealthComponent.pseudocode (Updated)
class HealthComponent implements IComponent:
    entity_id: EntityID // Store the ID of the entity this component belongs to
    current_health: integer
    max_health: integer
    event_bus: IEventManagementSystem // Reference to the global event bus

    function HealthComponent(owner_id: EntityID, initial_health: integer, initial_max_health: integer, bus: IEventManagementSystem):
        entity_id = owner_id
        current_health = initial_health
        max_health = initial_max_health
        event_bus = bus
        print(&quot;HealthComponent initialized for entity &quot; + entity_id)

    function TakeDamage(amount: integer):
        if current_health &lt;= 0: return // Already dead

        current_health = current_health - amount
        print(&quot;Entity &quot; + entity_id + &quot; took &quot; + amount + &quot; damage. Health: &quot; + current_health)

        // Publish a &quot;HealthChanged&quot; event
        event_bus.Publish(&quot;HealthChanged&quot;, { &quot;entity_id&quot;: entity_id, &quot;current_health&quot;: current_health, &quot;max_health&quot;: max_health })

        if current_health &lt;= 0:
            current_health = 0
            // Publish a &quot;EntityDied&quot; event
            event_bus.Publish(&quot;EntityDied&quot;, { &quot;entity_id&quot;: entity_id })
            print(&quot;Entity &quot; + entity_id + &quot; has died!&quot;)

    function Heal(amount: integer):
        current_health = min(current_health + amount, max_health)
        print(&quot;Entity &quot; + entity_id + &quot; healed &quot; + amount + &quot;. Health: &quot; + current_health)
        event_bus.Publish(&quot;HealthChanged&quot;, { &quot;entity_id&quot;: entity_id, &quot;current_health&quot;: current_health, &quot;max_health&quot;: max_health })

// Source/Gameplay/Systems/UIHealthDisplaySystem.pseudocode
class UIHealthDisplaySystem implements ISystem:
    event_bus: IEventManagementSystem
    // In a real UI system, this would manage actual UI elements
    // For pseudocode, we'll just print to console.
    player_health_display: string

    function Initialize(world: World): // World is passed, but not directly used by this simple UI system
        event_bus = global_event_system // Access the global event bus
        event_bus.Subscribe(&quot;HealthChanged&quot;, this.OnHealthChanged)
        event_bus.Subscribe(&quot;EntityDied&quot;, this.OnEntityDied)
        player_health_display = &quot;Player Health: ???/???&quot;
        print(&quot;UIHealthDisplaySystem initialized and subscribed to HealthChanged/EntityDied events.&quot;)

    function Update(delta_time: float):
        // UI systems often update themselves based on received events,
        // so this Update might not do much or just render.
        // print(&quot;UI Health Display: &quot; + player_health_display)
        pass

    function OnHealthChanged(event: Event):
        entity_id = event.data[&quot;entity_id&quot;]
        current_health = event.data[&quot;current_health&quot;]
        max_health = event.data[&quot;max_health&quot;]
        if entity_id == player_entity_id: // Assume player_entity_id is known or passed
            player_health_display = &quot;Player Health: &quot; + current_health + &quot;/&quot; + max_health
            print(&quot;UI Update: &quot; + player_health_display)
        else:
            print(&quot;UI Update: Entity &quot; + entity_id + &quot; health: &quot; + current_health + &quot;/&quot; + max_health)

    function OnEntityDied(event: Event):
        entity_id = event.data[&quot;entity_id&quot;]
        if entity_id == player_entity_id:
            player_health_display = &quot;Player: DEAD&quot;
            print(&quot;UI Update: Player has died! Game Over.&quot;)
        else:
            print(&quot;UI Update: Entity &quot; + entity_id + &quot; has died.&quot;)

    function Shutdown():
        event_bus.Unsubscribe(&quot;HealthChanged&quot;, this.OnHealthChanged)
        event_bus.Unsubscribe(&quot;EntityDied&quot;, this.OnEntityDied)
        print(&quot;UIHealthDisplaySystem unsubscribed.&quot;)
</code></pre>
<p><strong>4. Integrate with <code>Main</code> (Conceptual):</strong></p>
<p>The <code>Main</code> function will now instantiate the <code>EventBus</code> and register the <code>UIHealthDisplaySystem</code>.</p>
<pre><code class="language-pseudocode">// Source/Main.pseudocode (Updated conceptual application entry point)

// Global instance of core systems
// global_event_system needs to be declared before components that use it
global_event_system: IEventManagementSystem = new EventBus() // Concrete implementation

global_config_manager: ConfigManager = new ConfigManager()
global_input_system: IInputSystem = new InputSystemImplementation()
global_game_state_system: IGameStateSystem = new GameStateSystemImplementation()
global_resource_system: IResourceManagementSystem = new ResourceManagementSystemImplementation()
global_ui_system: IUIManagementSystem = new UIManagementSystemImplementation()


// Global reference to player entity ID for UI system (for demonstration)
player_entity_id: EntityID


function Main():
    print(&quot;Application starting...&quot;)

    global_config_manager.LoadConfig&lt;WeaponData&gt;(&quot;Config/Weapons/AssaultRifle.json&quot;, &quot;AssaultRifle_01&quot;)
    global_config_manager.LoadConfig&lt;WeaponData&gt;(&quot;Config/Weapons/Pistol.json&quot;, &quot;Pistol_01&quot;)

    game_world = new World()
    game_world.AddSystem(new MovementSystem())
    game_world.AddSystem(new UIHealthDisplaySystem()) // Add our UI system to the ECS world

    player_entity_id = game_world.CreateEntity() // Assign to global variable
    game_world.AddComponent(player_entity_id, new PositionComponent(0, 0, 0))
    game_world.AddComponent(player_entity_id, new VelocityComponent(1, 0, 0))
    game_world.AddComponent(player_entity_id, new HealthComponent(player_entity_id, 100, 100, global_event_system)) // Pass the event bus

    enemy_entity_id = game_world.CreateEntity()
    game_world.AddComponent(enemy_entity_id, new PositionComponent(10, 0, 0))
    game_world.AddComponent(enemy_entity_id, new VelocityComponent(-0.5, 0, 0))
    game_world.AddComponent(enemy_entity_id, new HealthComponent(enemy_entity_id, 50, 50, global_event_system)) // Also pass the event bus

    game_loop = new GameLoop(game_world)

    game_loop.RegisterSystem(global_input_system)
    game_loop.RegisterSystem(global_game_state_system)
    game_loop.RegisterSystem(global_event_system) // Register the EventBus as a core system as well
    game_loop.RegisterSystem(global_resource_system)
    game_loop.RegisterSystem(global_ui_system)

    // Simulate some events after setup:
    print(&quot;\n--- Simulating Gameplay Actions ---\n&quot;)
    player_health_comp = game_world.GetComponent&lt;HealthComponent&gt;(player_entity_id)
    if player_health_comp is not null:
        player_health_comp.TakeDamage(10)
        player_health_comp.TakeDamage(30)
        player_health_comp.Heal(5)
        player_health_comp.TakeDamage(100) // Should trigger death event

    print(&quot;\n--- Starting Game Loop (Conceptual) ---\n&quot;)
    // In a real scenario, the GameLoop's Update would run continuously,
    // and events would fire as game actions happen.
    // For this example, we've pre-simulated events.
    // game_loop.Run() 

    print(&quot;Application finished.&quot;)
</code></pre>
<h3 id="checkpoint-exercise">Checkpoint &amp; Exercise</h3>
<ul>
<li><strong>Task</strong>:<ol>
<li>Create <code>Event.pseudocode</code> in <code>Source/Core/Events/</code>.</li>
<li>Implement <code>EventBus.pseudocode</code> in <code>Source/Systems/EventManagement/</code>.</li>
<li>Update <code>HealthComponent.pseudocode</code> to publish <code>HealthChanged</code> and <code>EntityDied</code> events. Ensure it receives <code>IEventManagementSystem</code> in its constructor.</li>
<li>Create <code>UIHealthDisplaySystem.pseudocode</code> in <code>Source/Gameplay/Systems/</code> to subscribe to these events.</li>
<li>Update <code>Main.pseudocode</code> to instantiate the <code>EventBus</code>, pass it to <code>HealthComponent</code>s, register <code>UIHealthDisplaySystem</code> with the <code>World</code>, and simulate some damage.</li>
</ol>
</li>
<li><strong>Reflection</strong>: You've now implemented a powerful communication pattern. Observe how <code>HealthComponent</code> doesn't know about <code>UIHealthDisplaySystem</code>, and vice-versa. They communicate solely through the <code>EventBus</code>. This profound decoupling is a hallmark of robust, maintainable, and moddable AAA game architecture.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.sections", "navigation.expand", "content.code.copy"], "search": "../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>